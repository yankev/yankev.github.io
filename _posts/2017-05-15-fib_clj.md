---
layout: post
title:  "Generating the Fibonacci Sequence in Clojure"
date:   2017-05-15 18:46:00 -0500

---

So today I was looking at the problem of generating the fibonacci sequence in **Clojure**. Figuring out the value of the sequence at a certain value `n` was simple enough, but the solution to return an entire sequence seemed to elude me. So I did some searching, and it seems like the primary solutions involved the use of lazy-sequences. So I've decided to write about these methods as they do provide insight into lazy sequences and recursion in clojure.

-------------
{% highlight clojure %}
(defn simplefib [n]
 (case n
   0 0
   1 1
   (+ (simplefib (- n 1)) (simplefib (- n 2)))
 )
)

(simplefib 10)
; 55
{% endhighlight %}

So to get the `nth` we just have to use the definition of the fibonacci sequence in order to recursively build upwards, starting with the base cases. Now we move onto collecting these elements to return the full sequence up to the `nth` element.

#### The lazy sequence

The first method we're going to look at is possibly the closest and most recognizable to the simple recursive version we just looked at before.

{% highlight clojure %}
(defn get-fib-seq [x]
  (let [lazy-fib-seq
  ((fn build-fib [a b]
      (lazy-seq (cons a (build-fib b (+ a b))))
  ) 0 1)]
  (rest (take (+ x 1) lazy-fib-seq)))
)

(get-fib-seq 10)
; => (1 1 2 3 5 8 13 21 34 55)
{% endhighlight %}

Let's take a closer look.
1. The crux of the code relies on the definition of `lazy-fib-seq`
2. We create a recursive function `build-fib` which takes two values, presenting the `(n - 1)th` and `(n - 2)th` value, required in the fibonacci calculation.
3. We kick off the function call by call `build-fib` on 0 and 1.
4. Each time it concatenates `a` onto a lazy sequence, and saving the calculation `b` for a later time. More importantly though, `b` is defined as a recursive call, providing fresh `(n - 1)` and `(n - 2)` values for subsequent calculations.
5. So basically what we're left with is `lazy-fib-seq`, an infinite sequence of calculations to be performed as we go. Notice that we're actually building this sequence from the ground up, as we would if we were writing this using a loop in any other language.
6. Finally we return the first `x` number of values from this lazy-sequence using `take` (while omitting the inital 0 using `rest`).

And there you have it!


### Fenced code blocks

GitHub's fenced code blocks are also supported with **Highlight.js** syntax highlighting:

```
// Foo
var bar = 0;
```

> **Tip:** To use **Prettify** instead of **Highlight.js**, just configure the **Markdown Extra** extension in the <i class="icon-cog"></i> **Settings** dialog.

> **Note:** You can find more information:

> - about **Prettify** syntax highlighting [here][5],
> - about **Highlight.js** syntax highlighting [here][6].


### Footnotes

You can create footnotes like this[^footnote].

  [^footnote]: Here is the *text* of the **footnote**.


### SmartyPants

SmartyPants converts ASCII punctuation characters into "smart" typographic punctuation HTML entities. For example:

|                  | ASCII                        | HTML              |
 ----------------- | ---------------------------- | ------------------
| Single backticks | `'Isn't this fun?'`            | 'Isn't this fun?' |
| Quotes           | `"Isn't this fun?"`            | "Isn't this fun?" |
| Dashes           | `-- is en-dash, --- is em-dash` | -- is en-dash, --- is em-dash |

### Support StackEdit

[![](https://cdn.monetizejs.com/resources/button-32.png)](https://monetizejs.com/authorize?client_id=ESTHdCYOi18iLhhO&summary=true)

  [^stackedit]: [StackEdit](https://stackedit.io/) is a full-featured, open-source Markdown editor based on PageDown, the Markdown library used by Stack Overflow and the other Stack Exchange sites.


  [1]: http://math.stackexchange.com/
  [2]: http://daringfireball.net/projects/markdown/syntax "Markdown"
  [3]: https://github.com/jmcmanus/pagedown-extra "Pagedown Extra"
  [4]: http://meta.math.stackexchange.com/questions/5020/mathjax-basic-tutorial-and-quick-reference
  [5]: https://code.google.com/p/google-code-prettify/
  [6]: http://highlightjs.org/
  [7]: http://bramp.github.io/js-sequence-diagrams/
  [8]: http://adrai.github.io/flowchart.js/

